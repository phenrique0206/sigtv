CREATE SCHEMA IF NOT EXISTS GTVSM001;-- 

----------- GTVSM001.GTVTB005_ESTADO -----------

drop table if exists GTVSM001.GTVTB005_ESTADO CASCADE;
drop sequence if exists GTVSM001.GTVSQ006_ESTADO;

create sequence GTVSM001.GTVSQ006_ESTADO INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;

CREATE TABLE GTVSM001.GTVTB005_ESTADO
(
  NU_ESTADO BIGINT NOT NULL,
  SG_NOME   CHARACTER(2),
  CONSTRAINT PK_GTVTB005 PRIMARY KEY (NU_ESTADO)
);

----------- GTVSM001.GTVTB006_MUNICIPIO -----------

drop table if exists GTVSM001.GTVTB006_MUNICIPIO CASCADE;
drop sequence if exists GTVSM001.GTVSQ007_MUNICIPIO;

create sequence GTVSM001.GTVSQ007_MUNICIPIO INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;

CREATE TABLE GTVSM001.GTVTB006_MUNICIPIO
(
  NU_MUNICIPIO BIGINT NOT NULL,
  NO_NOME      CHARACTER VARYING (255),
  CO_CODIGO    CHARACTER VARYING (10),
  NU_ESTADO    BIGINT NOT NULL,
  CONSTRAINT   PK_GTVTB006 PRIMARY KEY (NU_MUNICIPIO),
  CONSTRAINT FK_GTVTB005_ESTADO_GTVTB006_MUNICIPIO FOREIGN KEY (NU_ESTADO) REFERENCES GTVSM001.GTVTB005_ESTADO (NU_ESTADO)
);

----------- GTVSM001.GTVTB001_EMPRESA -----------

drop table if exists GTVSM001.GTVTB001_EMPRESA CASCADE;
drop sequence if exists GTVSM001.GTVSQ001_EMPRESA;

create sequence GTVSM001.GTVSQ001_EMPRESA INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;

CREATE TABLE GTVSM001.GTVTB001_EMPRESA
(
  NU_EMPRESA      BIGINT NOT NULL,
  NO_NOME_REDUZIDO CHARACTER VARYING(255) NOT NULL,
  NO_RAZAO_SOCIAL CHARACTER VARYING(255) NOT NULL,
  NU_CNPJ         CHARACTER(14) NOT NULL UNIQUE,
  DE_OBSERVACAO   CHARACTER VARYING(255),
  IC_SITUACAO     CHARACTER VARYING(50),
  ED_ENDERECO     CHARACTER VARYING(255) NOT NULL,
  ED_BAIRRO       CHARACTER VARYING(255) NOT NULL,
  ED_NUMERO       INT NOT NULL,
  ED_COMPLEMENTO  CHARACTER VARYING(255),
  ED_CEP          CHARACTER(8) NOT NULL,
  NU_MUNICIPIO    BIGINT NOT NULL,
  CONSTRAINT PK_GTVTB001 PRIMARY KEY (NU_EMPRESA),
  CONSTRAINT FK_GTVTB001_EMPRESA_GTVTB006_MUNICIPIO FOREIGN KEY (NU_MUNICIPIO) REFERENCES GTVSM001.GTVTB006_MUNICIPIO (NU_MUNICIPIO)
);

----------- GTVSM001.GTVTB002_APOLICE -----------

drop table if exists GTVSM001.GTVTB002_APOLICE CASCADE;
drop sequence if exists GTVSM001.GTVSQ002_APOLICE;
drop sequence if exists GTVSM001.GTVSQ003_APOLICE_CO_CODIGO;

create sequence GTVSM001.GTVSQ002_APOLICE INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;
create sequence GTVSM001.GTVSQ003_APOLICE_CO_CODIGO INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;

CREATE TABLE GTVSM001.GTVTB002_APOLICE
(
  NU_APOLICE                BIGINT NOT NULL,
  CO_CODIGO                 INT NOT NULL DEFAULT nextval('GTVSM001.GTVSQ003_APOLICE_CO_CODIGO'),
  DH_DATA_INICIAL           DATE NOT NULL,
  DH_DATA_FINAL             DATE NOT NULL,
  IC_STATUS                 CHARACTER VARYING(50),
  IC_ATIVA                  BOOLEAN NOT NULL DEFAULT TRUE,
  NO_SEGURADORA             CHARACTER VARYING(255),
  NO_CORRETOR               CHARACTER VARYING(255),
  NU_TELEFONE               CHARACTER VARYING(15),
  NO_EMAIL                  CHARACTER VARYING(255),
  NU_ROTINEIRO_SEM_ESCOLTA  NUMERIC NOT NULL,
  NU_PONTO_A_PONTO          NUMERIC NOT NULL,
  NU_CALCADA                NUMERIC NOT NULL,
  NU_ABASTECIMENTO_PAE      NUMERIC,
  NU_AEREO                  NUMERIC,
  NU_FLUVIAL                NUMERIC,
  NU_PREMIO_TOTAL           NUMERIC,
  NO_HORARIO_PERMITIDO      CHARACTER VARYING(255),
  DH_DATA_PRIMEIRA_PARCELA  DATE,
  NU_PARCELAS               NUMERIC,
  NU_EMPRESA                BIGINT NOT NULL,
  CONSTRAINT PK_GTVTB002 PRIMARY KEY (NU_APOLICE),
  CONSTRAINT FK_GTVTB002_APOLICE_GTVTB001_EMPRESA FOREIGN KEY (NU_EMPRESA) REFERENCES GTVSM001.GTVTB001_EMPRESA (NU_EMPRESA)
);

----------- GTVSM001.GTVTB004_DEPARTAMENTO -----------

drop table if exists GTVSM001.GTVTB004_DEPARTAMENTO CASCADE;
drop sequence if exists GTVSM001.GTVSQ005_DEPARTAMENTO;

create sequence GTVSM001.GTVSQ005_DEPARTAMENTO INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;

CREATE TABLE GTVSM001.GTVTB004_DEPARTAMENTO
(
  NU_DEPARTAMENTO BIGINT NOT NULL,
  NO_NOME         CHARACTER VARYING(255),
  IC_FIXO         BOOLEAN NOT NULL,
  CONSTRAINT PK_GTVTB004 PRIMARY KEY (NU_DEPARTAMENTO)
);


----------- GTVSM001.GTVTB007_BASE -----------

drop table if exists GTVSM001.GTVTB007_BASE CASCADE;
drop sequence if exists GTVSM001.GTVSQ007_BASE;

create sequence GTVSM001.GTVSQ007_BASE INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;

CREATE TABLE GTVSM001.GTVTB007_BASE
(
  NU_BASE           BIGINT NOT NULL,
  IC_TIPO           CHARACTER VARYING(50) NOT NULL,
  NO_NOME           CHARACTER VARYING(255) NOT NULL,
  NU_CNPJ           CHARACTER(14) NOT NULL UNIQUE,
  DE_OBSERVACAO     CHARACTER VARYING(255),
  ED_ENDERECO       CHARACTER VARYING(255) NOT NULL,
  ED_BAIRRO         CHARACTER VARYING(255) NOT NULL,
  ED_NUMERO         INT NOT NULL,
  ED_COMPLEMENTO    CHARACTER VARYING(255),
  ED_CEP            CHARACTER(8) NOT NULL,
  IC_AUTORIZACAO_PF CHARACTER VARYING(50) NOT NULL,
  NU_MUNICIPIO      BIGINT NOT NULL,
  NU_EMPRESA        BIGINT NOT NULL,
  NU_BASE_GARAGEM   BIGINT,
  CONSTRAINT PK_GTVTB007 PRIMARY KEY (NU_BASE),
  CONSTRAINT FK_GTVTB007_BASE_GTVTB006_MUNICIPIO FOREIGN KEY (NU_MUNICIPIO) REFERENCES GTVSM001.GTVTB006_MUNICIPIO (NU_MUNICIPIO),
  CONSTRAINT FK_GTVTB007_BASE_GTVTB001_EMPRESA FOREIGN KEY (NU_EMPRESA) REFERENCES GTVSM001.GTVTB001_EMPRESA (NU_EMPRESA),
  CONSTRAINT FK_GTVTB007_BASE_GTVTB007_BASE FOREIGN KEY (NU_BASE_GARAGEM) REFERENCES GTVSM001.GTVTB007_BASE (NU_BASE)
);

----------- GTVSM001.GTVTB004_CONTATO -----------

drop table if exists GTVSM001.GTVTB003_CONTATO CASCADE;
drop sequence if exists GTVSM001.GTVSQ004_CONTATO;

create sequence GTVSM001.GTVSQ004_CONTATO INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;

CREATE TABLE GTVSM001.GTVTB003_CONTATO
(
  NU_CONTATO      BIGINT NOT NULL,
  NO_NOME         CHARACTER VARYING(255) NOT NULL,
  NU_TELEFONE     CHARACTER VARYING(15),
  NU_EMPRESA      BIGINT,
  NU_DEPARTAMENTO BIGINT NOT NULL,
  NU_BASE         BIGINT,
  CONSTRAINT PK_GTVTB003 PRIMARY KEY (NU_CONTATO),
  CONSTRAINT FK_GTVTB003_CONTATO_GTVTB001_EMPRESA FOREIGN KEY (NU_EMPRESA) REFERENCES GTVSM001.GTVTB001_EMPRESA (NU_EMPRESA),
  CONSTRAINT FK_GTVTB003_CONTATO_GTVTB004_DEPARTAMENTO FOREIGN KEY (NU_DEPARTAMENTO) REFERENCES GTVSM001.GTVTB004_DEPARTAMENTO (NU_DEPARTAMENTO),
  CONSTRAINT FK_GTVTB003_CONTATO_GTVTB007_BASE FOREIGN KEY (NU_BASE) REFERENCES GTVSM001.GTVTB007_BASE (NU_BASE)
);

----------- GTVSM001.GTVTB008_CONTATO_EMAIL -----------

drop table if exists GTVSM001.GTVTB008_CONTATO_EMAIL CASCADE;

CREATE TABLE GTVSM001.GTVTB008_CONTATO_EMAIL
(
  NU_CONTATO      BIGINT NOT NULL,
  NO_EMAIL        CHARACTER VARYING(255),
  CONSTRAINT PK_GTVTB008 PRIMARY KEY (NU_CONTATO, NO_EMAIL),
  CONSTRAINT FK_GTVTB008_CONTATO_EMAIL_GTVTB003_CONTATO FOREIGN KEY (NU_CONTATO) REFERENCES GTVSM001.GTVTB003_CONTATO (NU_CONTATO)
);


----------- GTVSM001.GTVTB009_DIVISAO_APOLICE_BASE -----------

drop table if exists GTVSM001.GTVTB009_DIVISAO_APOLICE_BASE CASCADE;

drop sequence if exists GTVSM001.GTVSQ009_DIVISAO_APOLICE_BASE;

create sequence GTVSM001.GTVSQ009_DIVISAO_APOLICE_BASE INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;


CREATE TABLE GTVSM001.GTVTB009_DIVISAO_APOLICE_BASE
(
  NU_DIVISAO      BIGINT NOT NULL,
  NU_BASE         BIGINT NOT NULL,
  NU_APOLICE      BIGINT NOT NULL,
  NU_COFRE_FORTE  NUMERIC NOT NULL,
  NU_TESOURARIA   NUMERIC NOT NULL,
  CONSTRAINT PK_GTVTB009 PRIMARY KEY (NU_DIVISAO),
  CONSTRAINT FK_GTVTB009_DIVISAO_APOLICE_BASE_GTVTB002_APOLICE FOREIGN KEY (NU_APOLICE) REFERENCES GTVSM001.GTVTB002_APOLICE (NU_APOLICE),
  CONSTRAINT FK_GTVTB009_DIVISAO_APOLICE_BASE_GTVTB007_BASE FOREIGN KEY (NU_BASE) REFERENCES GTVSM001.GTVTB007_BASE (NU_BASE)
);


----------- GTVSM001.GTVTB010_PARCELA -----------

drop table if exists GTVSM001.GTVTB010_PARCELA;

drop sequence if exists GTVSM001.GTVSQ010_PARCELA;

create sequence GTVSM001.GTVSQ010_PARCELA INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;
create sequence GTVSM001.GTVSQ011_PARCELA_CODIGO INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;


CREATE TABLE GTVSM001.GTVTB010_PARCELA
(
  NU_PARCELA         BIGINT NOT NULL,
  CO_CODIGO          INT NOT NULL DEFAULT nextval('GTVSM001.GTVSQ011_PARCELA_CODIGO'),
  NU_APOLICE         BIGINT NOT NULL,
  DH_DATA_VENCIMENTO DATE NOT NULL,
  NU_VALOR           NUMERIC NOT NULL,
  CONSTRAINT PK_GTVTB010 PRIMARY KEY (NU_PARCELA),
  CONSTRAINT FK_GTVTB010_PARCELA_GTVTB002_APOLICE FOREIGN KEY (NU_APOLICE) REFERENCES GTVSM001.GTVTB002_APOLICE (NU_APOLICE)
);

----------- GTVSM001.GTVTB011_ARQUIVO -----------

drop table if exists GTVSM001.GTVTB011_ARQUIVO;

drop sequence if exists GTVSM001.GTVSQ011_ARQUIVO;

create sequence GTVSM001.GTVSQ011_ARQUIVO INCREMENT BY 1 MINVALUE 1	MAXVALUE 9223372036854775807 START 1;


CREATE TABLE GTVSM001.GTVTB011_ARQUIVO
(
  NU_ARQUIVO         BIGINT NOT NULL,
  NO_NOME            CHARACTER VARYING(512),
  NO_CONTENT_TYPE    CHARACTER VARYING(512),
  NU_TAMANHO         NUMERIC NOT NULL,
  CO_UUID            CHARACTER VARYING(36),
  CONSTRAINT PK_GTVTB011 PRIMARY KEY (NU_ARQUIVO)
);

----------- GTVSM001.GTVTB012_APOLICE_ARQUIVO -----------

drop table if exists GTVSM001.GTVTB012_APOLICE_ARQUIVO;

CREATE TABLE GTVSM001.GTVTB012_APOLICE_ARQUIVO
(
  NU_APOLICE         BIGINT NOT NULL,
  NU_ARQUIVO         BIGINT NOT NULL,
  CONSTRAINT PK_GTVTB012 PRIMARY KEY (NU_APOLICE, NU_ARQUIVO),
  CONSTRAINT FK_GTVTB012_APOLICE_ARQUIVO_GTVTB002_APOLICE FOREIGN KEY (NU_APOLICE) REFERENCES GTVSM001.GTVTB002_APOLICE (NU_APOLICE),
  CONSTRAINT FK_GTVTB012_APOLICE_ARQUIVO_GTVTB011_ARQUIVO FOREIGN KEY (NU_ARQUIVO) REFERENCES GTVSM001.GTVTB011_ARQUIVO (NU_ARQUIVO)
);

----------- GTVSM001.GTVTB013_PARCELA_ARQUIVO -----------

drop table if exists GTVSM001.GTVTB013_PARCELA_ARQUIVO;

CREATE TABLE GTVSM001.GTVTB013_PARCELA_ARQUIVO
(
  NU_PARCELA         BIGINT NOT NULL,
  NU_ARQUIVO         BIGINT NOT NULL,
  CONSTRAINT PK_GTVTB013 PRIMARY KEY (NU_ARQUIVO, NU_PARCELA),
  CONSTRAINT FK_GTVSM013_GTVTB013_PARCELA_ARQUIVO_GTVTB010_PARCELA FOREIGN KEY (NU_PARCELA) REFERENCES GTVSM001.GTVTB010_PARCELA (NU_PARCELA),
  CONSTRAINT FK_GTVSM013_GTVTB013_PARCELA_ARQUIVO_GTVTB011_ARQUIVO FOREIGN KEY (NU_ARQUIVO) REFERENCES GTVSM001.GTVTB011_ARQUIVO (NU_ARQUIVO)
);
